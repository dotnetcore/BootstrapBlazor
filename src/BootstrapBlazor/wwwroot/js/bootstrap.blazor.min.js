(function(n){function f(t){return this.each(function(){var u=n(this),r=u.data(i.DATA_KEY),f=typeof t=="object"&&t;r||u.data(i.DATA_KEY,r=new i(this,f));typeof t=="string"&&/active/.test(t)&&r[t].apply(r)})}function e(t){return this.each(function(){var u=n(this),i=u.data(r.DATA_KEY),f=typeof t=="object"&&t;i?i.update(f):u.data(r.DATA_KEY,i=new r(this,f))})}function o(t){return this.each(function(){var r=n(this),i=r.data(u.DATA_KEY),f=typeof t=="object"&&t;i||r.data(u.DATA_KEY,i=new u(this,f));typeof t=="string"&&/Reset/.test(t)&&i.resetall.apply(i)})}var i,r,u,t;n.isFunction(Date.prototype.format)||(Date.prototype.format=function(n){var i={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours()%12==0?12:this.getHours()%12,"H+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()},t;/(y+)/.test(n)&&(n=n.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));/(E+)/.test(n)&&(n=n.replace(RegExp.$1,(RegExp.$1.length>1?RegExp.$1.length>2?"星期":"周":"")+{0:"日",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六"}[this.getDay()]));for(t in i)new RegExp("("+t+")").test(n)&&(n=n.replace(RegExp.$1,RegExp.$1.length===1?i[t]:("00"+i[t]).substr((""+i[t]).length)));return n});n.browser={versions:function(){var n=navigator.userAgent;return{trident:n.indexOf("Trident")>-1,presto:n.indexOf("Presto")>-1,webKit:n.indexOf("AppleWebKit")>-1,gecko:n.indexOf("Gecko")>-1&&n.indexOf("KHTML")===-1,mobile:!!n.match(/AppleWebKit.*Mobile.*/),ios:!!n.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:n.indexOf("Android")>-1||n.indexOf("Linux")>-1,iPhone:n.indexOf("iPhone")>-1,iPod:n.indexOf("iPod")>-1,iPad:n.indexOf("iPad")>-1,mac:n.indexOf("Macintosh")>-1,webApp:n.indexOf("Safari")===-1}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};n.blazorCulture={get:()=>window.localStorage.BlazorCulture,set:n=>{window.localStorage.BlazorCulture=n}};n.generatefile=(n,t,i)=>{var r=document.createElement("a");r.download=n;r.href="data:"+i+";base64,"+t;document.body.appendChild(r);r.click();document.body.removeChild(r)};window.Toasts=[];Array.prototype.indexOf=function(n){for(var t=0;t<this.length;t++)if(this[t]==n)return t;return-1};Array.prototype.remove=function(n){var t=this.indexOf(n);t>-1&&this.splice(t,1)};i=function(t,i){this.$element=n(t);this.$header=this.$element.find(".tabs-header");this.$wrap=this.$header.find(".tabs-nav-wrap");this.$scroll=this.$wrap.find(".tabs-nav-scroll");this.$tab=this.$scroll.find(".tabs-nav");this.options=n.extend({},i);this.init()};i.VERSION="3.1.0";i.Author="argo@163.com";i.DATA_KEY="lgb.Tab";t=i.prototype;t.init=function(){var t=this;n(window).on("resize",function(){t.resize()});this.active()};t.fixSize=function(){var n=this.$element.height(),t=this.$element.width();this.$element.css({height:n+"px",width:t+"px"})};t.resize=function(){var n,t,i,r,u;this.vertical=this.$element.hasClass("tabs-left")||this.$element.hasClass("tabs-right");this.horizontal=this.$element.hasClass("tabs-top")||this.$element.hasClass("tabs-bottom");n=this.$tab.find(".tabs-item:last");n.length>0&&(this.vertical?(this.$wrap.css({height:this.$element.height()+"px"}),t=this.$tab.height(),i=n.position().top+n.outerHeight(),i<t?this.$wrap.removeClass("is-scrollable"):this.$wrap.addClass("is-scrollable")):(this.$wrap.removeAttr("style"),r=this.$tab.width(),u=n.position().left+n.outerWidth(),u<r?this.$wrap.removeClass("is-scrollable"):this.$wrap.addClass("is-scrollable")))};t.active=function(){var r,n,f,o,c,l;if(this.resize(),r=this.$element.find(".tabs-active-bar"),n=this.$element.find(".tabs-item.is-active"),n.length!==0)if(this.vertical){var u=n.position().top,a=u+n.outerHeight(),t=this.$scroll.scrollTop(),v=this.$scroll.outerHeight(),s=a-t-v;s>0?this.$scroll.scrollTop(t+s):(f=u-t,f<0&&this.$scroll.scrollTop(t+f));r.css({width:"2px",transform:"translateY("+u+"px)"})}else{var e=n.position().left,y=e+n.outerWidth(),i=this.$scroll.scrollLeft(),p=this.$scroll.width(),h=y-i-p;h>0?this.$scroll.scrollLeft(i+h):(o=e-i,o<0&&this.$scroll.scrollLeft(i+o));c=n.width();l=e+parseInt(n.css("paddingLeft"));r.css({width:c+"px",transform:"translateX("+l+"px)"})}};n.fn.tab=f;n.fn.tab.Constructor=i;r=function(t,i){this.$element=n(t);this.options=n.extend({},i);this.init()};r.VERSION="3.1.0";r.Author="argo@163.com";r.DATA_KEY="lgb.SliderCaptcha";t=r.prototype;t.init=function(){this.initDOM();this.initImg();this.bindEvents()};t.initDOM=function(){var u=this.$element.find("canvas:first")[0].getContext("2d"),t=this.$element.find("canvas:last")[0],f=t.getContext("2d"),e=this.$element.find(".captcha-load"),i=this.$element.find(".captcha-footer"),o=i.find(".captcha-bar-bg"),s=this.$element.find(".captcha-bar"),r=this.$element.find(".captcha-bar-text"),h=this.$element.find(".captcha-refresh"),c=r.attr("data-text");n.extend(this,{canvas:u,block:t,bar:f,$load:e,$footer:i,$barLeft:o,$slider:s,$barText:r,$refresh:h,barText:c})};t.initImg=function(){var i=function(n,t){var i=this.options.sideLength,f=this.options.diameter,e=Math.PI,r=this.options.offsetX,u=this.options.offsetY;n.beginPath();n.moveTo(r,u);n.arc(r+i/2,u-f+2,f,.72*e,2.26*e);n.lineTo(r+i,u);n.arc(r+i+f-2,u+i/2,f,1.21*e,2.78*e);n.lineTo(r+i,u+i);n.lineTo(r,u+i);n.arc(r+f-2,u+i/2,f+.4,2.76*e,1.24*e,!0);n.lineTo(r,u);n.lineWidth=2;n.fillStyle="rgba(255, 255, 255, 0.7)";n.strokeStyle="rgba(255, 255, 255, 0.7)";n.stroke();n[t]();n.globalCompositeOperation="destination-over"},t=new Image,n;t.src=this.options.imageUrl;n=this;t.onload=function(){i.call(n,n.canvas,"fill");i.call(n,n.bar,"clip");n.canvas.drawImage(t,0,0,n.options.width,n.options.height);n.bar.drawImage(t,0,0,n.options.width,n.options.height);var r=n.options.offsetY-n.options.diameter*2-1,u=n.bar.getImageData(n.options.offsetX-3,r,n.options.barWidth,n.options.barWidth);n.block.width=n.options.barWidth;n.bar.putImageData(u,0,r)};t.onerror=function(){n.$load.text($load.attr("data-failed")).addClass("text-danger")}};t.bindEvents=function(){var n=this,t=0,i=0,r=[];this.$slider.drag(function(r){n.$barText.addClass("d-none");t=r.clientX||r.touches[0].clientX;i=r.clientY||r.touches[0].clientY},function(u){var o=u.clientX||u.touches[0].clientX,s=u.clientY||u.touches[0].clientY,f=o-t,h=s-i,e;if(f<0||f+40>n.options.width)return!1;n.$slider.css({left:f-1+"px"});e=(n.options.width-60)/(n.options.width-40)*f;n.block.style.left=e+"px";n.$footer.addClass("is-move");n.$barLeft.css({width:f+4+"px"});r.push(Math.round(h))},function(i){var f=i.clientX||i.changedTouches[0].clientX,u;n.$footer.removeClass("is-move");u=Math.ceil((n.options.width-60)/(n.options.width-40)*(f-t)+3);n.verify(u,r)});this.$refresh.on("click",function(){n.options.barText=n.$barText.attr("data-text")})};t.verify=function(n,t){var r=this.options.remoteObj.obj,u=this.options.remoteObj.method,i=this;r.invokeMethodAsync(u,n,t).then(function(n){n?(i.$footer.addClass("is-valid"),i.options.barText=i.$barText.attr("data-text")):(i.$footer.addClass("is-invalid"),setTimeout(function(){i.$refresh.trigger("click");i.options.barText=i.$barText.attr("data-try")},1e3))})};t.update=function(t){n.extend(this.options,t);this.resetCanvas();this.initImg();this.resetBar()};t.resetCanvas=function(){this.canvas.clearRect(0,0,this.options.width,this.options.height);this.bar.clearRect(0,0,this.options.width,this.options.height);this.block.width=this.options.width;this.block.style.left=0;this.$load.text(this.$load.attr("data-load")).removeClass("text-danger")};t.resetBar=function(){this.$footer.removeClass("is-invalid is-valid");this.$barText.text(this.options.barText).removeClass("d-none");this.$slider.css({left:"0px"});this.$barLeft.css({width:"0px"})};n.fn.sliderCaptcha=e;n.fn.sliderCaptcha.Constructor=r;u=function(t,i){this.$element=n(t);this.options=n.extend({},i);this.init()};u.VERSION="3.1.0";u.Author="argo@163.com";u.DATA_KEY="lgb.Uploader";t=u.prototype;t.init=function(){var t=this;this.$fileItem=this.$element.find(".upload-list .upload-list-item:first");this.$file=this.$element.find(":file");this.showProgress=this.$element.hasClass("is-progress");this.prev=this.$element.hasClass("is-prev");this.iscircle=this.$element.hasClass("is-circle");this.iswall=this.$element.hasClass("is-wall");this.iscard=this.$element.hasClass("is-card");this.isstack=this.$element.hasClass("is-stack");this.url=this.$element.attr("data-url");this.multiple=this.$element.find(":file").attr("multiple")==="multiple";this.files=[];(this.iswall||this.multiple)&&(this.$item=this.$element.find(".upload-prev:first").clone());this.$element.on("click",".upload-prev",function(){t.$element.hasClass("is-disabled")||t.isstack||n(this).hasClass("is-upload")||n(this).hasClass("is-uploading")||(t.$prev=n(this),t.$file.trigger("click"))});this.$element.on("click",".btn-upload",function(){t.$element.hasClass("is-disabled")||(t.isstack?t.$file.trigger("click"):n.each(t.files,function(){t.upload(this.file,this.$prev)}),t.files=[])});this.$element.on("click",".upload-prev .upload-item-delete, .upload-prev .btn-delete",function(i){if(!t.$element.hasClass("is-disabled")){var r=n(this).parents(".upload-prev"),u=r.attr("data-file");r.hasClass("is-invalid-file")?r.remove():n.ajax({url:t.url,method:"delete",data:JSON.stringify(u),contentType:"application/json",dataType:"json",success:function(n){if(n){t.reset.call(t,r);var i=t.options.remoteObj;i.obj.invokeMethodAsync(i.del,u)}},error:function(){t.failed(i,r,{name:u})}})}});this.$file.on("change",function(){t.fileSelected.call(t)});this.url||(this.url="api/Upload")};t.reset=function(n){this.iswall||this.multiple?n.remove():(n.find("img").removeClass("d-block"),n.find(".fa-plus").removeClass("d-none"),n.removeClass("is-upload is-invalid is-valid is-load is-file"),n.removeAttr("data-file"),n.find(".upload-prev-progress-cur").css({width:"0"}),n.find(".upload-prev-progress-text").html("0 %"),this.iscircle&&this.toggleCircle(n,!1))};t.resetall=function(){if(this.iswall||this.multiple)this.$element.find(".upload-body .upload-prev.is-load, .upload-body .upload-prev.is-file").remove();else{var n=this.$element.find(".upload-body .upload-prev");n.find("img").removeClass("d-block");n.find(".fa-plus").removeClass("d-none");n.removeClass("is-upload is-invalid is-valid is-load is-file");n.removeAttr("data-file");n.find(".upload-prev-progress-cur").css({width:"0"});n.find(".upload-prev-progress-text").html("0 %");this.iscircle&&this.toggleCircle(n,!1)}};t.fileSelected=function(){var t=this,i;this.$file[0].files.length!==0&&(i=this.isstack?this.$item.clone():this.$prev,this.isstack&&i.addClass("d-flex").insertAfter(this.$element.find(".upload-prev:first")),n.each(this.$file[0].files,function(n){var u=t.options.remoteObj,r=this;u.obj.invokeMethodAsync(u.check,r.name,r.type,r.size).then(function(u){var f,e;u.result?(i.addClass("is-active").removeClass("is-invalid is-valid").tooltip("dispose"),t.iscircle&&t.toggleCircle(i,!0),t.prevFile.call(t,r,i),t.setUploadItem.call(t,r,i),t.prev?(f=i.attr("data-file"),f&&(e=t.files.findIndex(function(n){return n.file.name===f}),e>-1&&t.files.splice(e,1)),i.attr("data-file",r.name),t.files.push({file:r,$prev:i})):t.upload(r,i),(t.iswall||t.multiple)&&(i=t.$item.clone(),t.isstack?n+1<t.$file[0].files.length&&i.addClass("d-flex").insertAfter(t.$element.find(".upload-prev:first")):i.insertAfter(t.$element.find(".upload-prev:last")))):t.isstack?(i.addClass("is-invalid is-invalid-file"),i.find(".upload-prev-invalid-file .file-name").html(r.name),i.find(".upload-prev-invalid-file .file-error").html(u.message)):(i.removeClass("is-upload is-active").addClass("is-invalid"),t.showError(i,u.message))})}))};t.prevFile=function(n,t){var i,r;n.type.startsWith("image")?(i=new FileReader,i.onloadend=function(n){t.removeClass("is-active").addClass("is-load").find("img").attr("src",n.target.result)},i.readAsDataURL(n)):(t.addClass("is-file"),r=t.find(".upload-file-icon"),r.html(""),r.append(this.createIcon(n.type)))};t.createIcon=function(t){var i=n('<i class="fa"><\/fa>');return t==="application/x-zip-compressed"?i.addClass("fa-file-archive-o"):t==="application/vnd.openxmlformats-officedocument.wordprocessingml.document"?i.addClass("fa-file-word-o"):t==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"?i.addClass("fa-file-excel-o"):t==="application/vnd.openxmlformats-officedocument.presentationml.presentation"?i.addClass("fa-file-powerpoint-o"):t.startsWith("audio")?i.addClass("fa-file-audio-o"):t.startsWith("video")?i.addClass("fa-file-video-o"):t==="application/pdf"?i.addClass("fa-file-pdf-o"):i.addClass("fa-file-text-o"),i};t.showError=function(n,t){n.attr("data-original-title",t);n.attr("data-container","body");n.tooltip("show")};t.setUploadItem=function(n,t){if(n){var i=0;i=n.size>1048576?(Math.round(n.size*100/1048576)/100).toString()+"MB":(Math.round(n.size*100/1024)/100).toString()+"KB";t.find(".upload-list-item-text").text(n.name);t.find(".upload-list-item-size").text(i)}};t.calcSize=function(n){return n>1048576?(Math.round(n*100/1048576)/100).toString()+" MB":(Math.round(n*100/1024)/100).toString()+" KB"};t.progress=function(n,t){var i,r,u,f;n.lengthComputable&&(i=Math.round(n.loaded*100/n.total),this.iscircle?(r=t.find(".upload-item-circle-progress"),r.attr("stroke-dashoffset","0"),u=parseFloat(r.attr("data-dash")),f=i*u/100,r.attr("stroke-dasharray",f+","+u)):this.showProgress&&(t.find(".upload-prev-progress-text").html(i+" %"),t.find(".upload-prev-progress-cur").css({width:i+"%"}),this.calcRate(n.loaded,n.total,t)))};t.calcRate=function(n,t,i){var e=i.find(".upload-list-item-rate"),r,u,f;t>1048576&&(this.ticks||(this.ticks=(new Date).getTime()),r=(new Date).getTime()-this.ticks,r===0&&(r=1),u=n*1e3/r,f=this.calcSize(u),e.html(f+"/s"))};t.toggleCircle=function(n,t){var u=n.find(".upload-item-circle"),i,r;t?u.removeClass("d-none"):(u.addClass("d-none"),i=n.find(".upload-item-circle-progress"),r=parseFloat(i.attr("data-dash")),i.attr("stroke-dashoffset",r),i.attr("stroke-dasharray",r+","+r))};t.toggleLabel=function(n,t){var i=n.find(".upload-item-label");t?i.removeClass("d-none"):i.addClass("d-none")};t.complete=function(t,i,r){var u=this,e=!0,f;try{f=JSON.parse(t.target.response);n.isArray(f)&&(n.each(f,function(t,f){if(f.originFileName==r.name&&(i.addClass("is-upload is-valid"),i.removeClass("is-invalid is-uploading"),i.hasClass("is-file")||i.find("img").attr("src",f.prevUrl+"?v="+n.getUID()),i.attr("data-file",f.fileName),u.options.remoteObj.obj.invokeMethodAsync(u.options.remoteObj.complete,r.name,f.prevUrl)),u.iscard){var e=u.calcSize(r.size);i.find(".upload-list-item-size").html("("+e+")")}}),e=!1)}catch(o){console.log(o)}e&&this.failed(t,i,r)};t.failed=function(n,t,i){t.addClass("is-invalid");var r=this.options.remoteObj;r.obj.invokeMethodAsync(r.failed,i.name);this.showError(t,"服务器端错误上传失败")};t.cancel=function(){alert("The upload has been canceled by the user or the browser dropped the connection.")};t.upload=function(t,i){var r=this,f=new FormData,u,e;f.append(t.name,t);u=new XMLHttpRequest;(this.showProgress||this.iscircle)&&u.upload.addEventListener("progress",function(n){r.progress.call(r,n,i)});u.addEventListener("error",function(n){r.failed.call(r,n,i,t)});u.addEventListener("abort",function(n){r.cancel.call(r,n,i,t)});u.addEventListener("load",function(n){r.complete.call(r,n,i,t)});u.open("POST",this.url);e=this.options.remoteObj.setHeaders;this.options.remoteObj.obj.invokeMethodAsync(e).then(function(t){n.isArray(t)&&n.each(t,function(){u.setRequestHeader(this.name,this.value)});u.send(f);i.removeClass("is-active").addClass("is-uploading")})};n.fn.uploader=o;n.fn.uploader.Constructor=u;n.fn.extend({drag:function(t,i,r){var u=n(this),o=function(i){i.stopPropagation();document.addEventListener("mousemove",f);document.addEventListener("touchmove",f);document.addEventListener("mouseup",e);document.addEventListener("touchend",e);n.isFunction(t)&&t.call(u,i)},f=function(t){n.isFunction(i)&&i.call(u,t)},e=function(t){n.isFunction(r)&&r.call(u,t);window.setTimeout(function(){document.removeEventListener("mousemove",f);document.removeEventListener("touchmove",f);document.removeEventListener("mouseup",e);document.removeEventListener("touchend",e)},100)};u.on("mousedown",o);u.on("touchstart",o)}});n.extend({html5edit:function(t,i){if(n.isFunction(n.fn.summernote)){var r=n(t),u=typeof i=="object"&&i;return/destroy|hide/.test(i)?r.toggleClass("open").summernote(i):typeof i=="string"?r.hasClass("open")?r.summernote(i):r.html():(u=n.extend({focus:!0,lang:"zh-CN",height:80,dialogsInBody:!0},u),r.on("click",u,function(t,i){var u=n(this).tooltip("hide"),r=n.extend({placeholder:u.attr("placeholder")},t.data,i||{});r.obj.invokeMethodAsync("GetToolBar").then(t=>{var i=u.toggleClass("open").summernote(n.extend({callbacks:{onChange:function(n){r.obj.invokeMethodAsync(r.method,n)}},toolbar:t},r)).next().find(".note-toolbar").on("click","button[data-method]",{note:u,op:r},function(t){var r=n(this),i,u;switch(r.attr("data-method")){case"submit":r.tooltip("dispose");i=t.data.note.toggleClass("open");u=i.summernote("code");i.summernote("destroy");t.data.op.obj.invokeMethodAsync(t.data.op.method,u)}}),f=n('<div class="note-btn-group btn-group note-view note-right"><button type="button" class="note-btn btn btn-sm note-btn-close" tabindex="-1" data-method="submit" title="完成" data-placement="bottom"><i class="fa fa-check"><\/i><\/button><\/div>').appendTo(i).find("button").tooltip({container:"body"});n("body").find('.note-group-select-from-files [accept="image/*"]').attr("accept","image/bmp,image/png,image/jpg,image/jpeg,image/gif")})}).tooltip({title:"点击展开编辑"}),u.value&&r.html(u.value),r.hasClass("open")&&r.trigger("click",{focus:!1}),this)}},format:function(t,i){return i===undefined||i===null?null:(arguments.length>2&&i.constructor!==Array&&(i=n.makeArray(arguments).slice(1)),i.constructor!==Array&&(i=[i]),n.each(i,function(n,i){t=t.replace(new RegExp("\\{"+n+"\\}","g"),function(){return i})}),t)},getUID:function(n){n||(n="b");do n+=~~(Math.random()*1e6);while(document.getElementById(n));return n},showMessage:function(t,i,r){window.Messages||(window.Messages=[]);Messages.push(t);var u=n(t),e=u.attr("data-autohide")!=="false",o=parseInt(u.attr("data-delay")),f=null,s=window.setTimeout(function(){window.clearTimeout(s);e&&(f=window.setTimeout(function(){window.clearTimeout(f);u.close()},o));u.addClass("show")},50);u.close=function(){f!=null&&window.clearTimeout(f);u.removeClass("show");var n=window.setTimeout(function(){window.clearTimeout(n);Messages.remove(t);Messages.length===0&&i.invokeMethodAsync(r)},500)};u.on("click",".close",function(n){n.preventDefault();n.stopPropagation();u.close()})},bb_pop:function(t,i){var r=n(t);i==="init"?r.appendTo(n("body")):i==="dispose"&&r.remove()},showToast:function(t,i,r){var f,o;Toasts.push(t);var u=n(t),s=u.attr("data-autohide")!=="false",e=parseInt(u.attr("data-delay"));u.addClass("d-block");f=null;o=window.setTimeout(function(){window.clearTimeout(o);s&&(u.find(".toast-progress").css({width:"100%",transition:"width "+e/1e3+"s linear"}),f=window.setTimeout(function(){window.clearTimeout(f);u.find(".close").trigger("click")},e));u.addClass("show")},50);u.on("click",".close",function(n){n.preventDefault();n.stopPropagation();f!=null&&window.clearTimeout(f);u.removeClass("show");var t=window.setTimeout(function(){window.clearTimeout(t);u.removeClass("d-block");Toasts.remove(u[0]);Toasts.length===0&&i.invokeMethodAsync(r)},500)})},bb_carousel:function(t){var r=n(t).carousel(),i=null;r.hover(function(){var t,r,u;i!=null&&window.clearTimeout(i);t=n(this);r=t.find("[data-slide]");r.removeClass("d-none");u=window.setTimeout(function(){window.clearTimeout(u);t.addClass("hover")},10)},function(){var t=n(this),r=t.find("[data-slide]");t.removeClass("hover");i=window.setTimeout(function(){window.clearTimeout(i);r.addClass("d-none")},300)})},slider:function(t,i,r){var f=n(t),s=f.find(".disabled").length>0;if(!s){var e=0,o=0,u=0,h=f.innerWidth();f.find(".slider-button-wrapper").drag(function(n){e=n.clientX||n.touches[0].clientX;o=parseInt(f.attr("aria-valuetext"));f.find(".slider-button-wrapper, .slider-button").addClass("dragging")},function(n){var t=n.clientX||n.changedTouches[0].clientX;u=Math.ceil((t-e)*100/h)+o;u<=0&&(u=0);u>=100&&(u=100);f.find(".slider-bar").css({width:u.toString()+"%"});f.find(".slider-button-wrapper").css({left:u.toString()+"%"});f.attr("aria-valuetext",u.toString());i.invokeMethodAsync(r,u)},function(){f.find(".slider-button-wrapper, .slider-button").removeClass("dragging");i.invokeMethodAsync(r,u)})}},bb_tooltip:function(t,i,r,u,f,e){var h={html:f,sanitize:!f,title:r,placement:u,trigger:e},o=n("#"+t),s;i===""?(o.data("bs.tooltip")&&o.tooltip("dispose"),o.tooltip(h)):i==="enable"?(o.data("bs.tooltip")&&o.tooltip("dispose"),o.tooltip(h),s=o.parents("form").find(".is-invalid:first"),s.prop("nodeName")==="INPUT"?s.prop("readonly")?s.trigger("focus"):s.focus():s.prop("nodeName")==="DIV"&&s.trigger("focus")):i==="dispose"?o.data("bs.tooltip")&&o.tooltip(i):(o.data("bs.tooltip")||o.tooltip(h),o.tooltip(i))},bb_popover:function(t,i,r,u,f,e,o){var s=n("#"+t),h={html:e,sanitize:!1,title:r,content:u,placement:f,trigger:o};i===""?(s.data("bs.popover")&&s.popover("dispose"),s.popover(h)):i==="dispose"?s.data("bs.popover")&&s.popover(i):(s.data("bs.popover")||s.popover(h),s.popover(i))},bb_confirm:function(t){var r=n('[data-target="'+t+'"]'),i=n("#"+t);i.popover({toggle:"confirm",html:!0,sanitize:!1,content:r.find(".popover-body").html()});i.popover("show")},bb_modal:function(t,i){var u=n(t);if(i==="dispose")u.remove();else if(i==="init"){if(u.closest(".swal").length===0){n("body").append(u);var o=0,s=0,e=0,h=0,f={top:0,left:0},r=null;u.find(".is-draggable .modal-header").drag(function(n){o=n.clientX||n.touches[0].clientX;s=n.clientY||n.touches[0].clientY;r=this.closest(".modal-dialog");e=r.width();h=r.height();f.top=parseInt(r.css("marginTop").replace("px",""));f.left=parseInt(r.css("marginLeft").replace("px",""));r.css({marginLeft:f.left,marginTop:f.top});r.removeClass("modal-dialog-centered");r.css("width",e);this.addClass("is-drag")},function(t){var i=t.clientX||t.changedTouches[0].clientX,u=t.clientY||t.changedTouches[0].clientY;newValX=f.left+Math.ceil(i-o);newValY=f.top+Math.ceil(u-s);newValX<=0&&(newValX=0);newValY<=0&&(newValY=0);newValX+e<n(window).width()&&r!=null&&r.css({marginLeft:newValX});newValY+h<n(window).height()&&r!=null&&r.css({marginTop:newValY})},function(){this.removeClass("is-drag")})}u.on("shown.bs.modal",function(){n(document).one("keyup",function(n){if(n.key==="Escape"){var i=u.find(".modal-dialog"),t=i.data("bb_dotnet_invoker");t!=null&&t.invokeMethodAsync("Close")}})})}else u.modal(i)},bb_dialog:function(t,i,r){var u=n(t);r==="init"&&u.data("bb_dotnet_invoker",i)},bb_filter:function(t,i,r){n(t).data("bb_filter",{obj:i,method:r})},bb_table_resize:function(t){var u=t.find(".col-resizer");if(u.length>0){var f=function(t){var u=n(this),i=u.closest("th");t?i.addClass("border-resize"):i.removeClass("border-resize");var r=i.index(),f=i.closest(".table-resize").find("tbody"),e=f.find("tr").each(function(){var i=n(this.children[r]);t?i.addClass("border-resize"):i.removeClass("border-resize")});return r},i=0,e=0,r=0,o=0;u.each(function(){n(this).drag(function(u){r=f.call(this,!0);var s=t.find("table colgroup col")[r].width;i=s?parseInt(s):n(this).closest("th").width();e=n(this).closest("table").width();o=u.clientX},function(u){t.find("table colgroup").each(function(t,f){var h=n(f).find("col")[r],s=u.clientX-o;h.width=i+s;t===0&&n(f).closest("table").width(e+s)})},function(){f.call(this,!1)})})}},bb_table:function(t,i,r){var u=n(t),h=u.find(".btn-col"),y,c,s,f,e,l,o,a,v,p;if(!h.hasClass("init")){h.addClass("init");h.on("click",function(){var t=n(this).next();t.toggleClass("show")})}if(i==="fixTableHeader"){y=u.find(".table-fixed-header");c=u.find(".table-fixed-body");c.on("scroll",function(){var n=c.scrollLeft();y.scrollLeft(n)});if(s=u.find(".fixed-scroll"),s.length===1){for(f=s.prev();f.length===1;)if(f.hasClass("fixed-right")&&!f.hasClass("modified"))e=f.css("right"),e=e.replace("px",""),n.browser.versions.mac?e=parseFloat(e)-2+"px":n.browser.versions.mobile&&(e=parseFloat(e)-17+"px"),f.css({right:e}).addClass("modified"),f=f.prev();else break;n.browser.versions.mobile&&s.remove()}u.find(".col-resizer:last").remove();n.bb_table_resize(u)}else if(i==="init"){l=u.find(".table-cell.is-sort .table-text");o={unset:"点击升序",sortAsc:"点击降序",sortDesc:"取消排序"};l.each(function(){var i=n(this).parent().find(".fa:last"),t;i.length>0&&(t=o.unset,i.hasClass("fa-sort-asc")?t=o.sortAsc:i.hasClass("fa-sort-desc")&&(t=o.sortDesc),n(this).tooltip({container:"body",title:t}))});l.on("click",function(){var i=n(this),u=i.parent().find(".fa:last"),t="sortAsc",r,f;u.hasClass("fa-sort-asc")?t="sortDesc":u.hasClass("fa-sort-desc")&&(t="unset");r=n("#"+i.attr("aria-describedby"));r.length>0&&(f=r.find(".tooltip-inner"),f.html(o[t]),i.attr("data-original-title",o[t]))});a=u.find(".table-toolbar");v=0;a.length>0&&(v=a.height());u.find(".filterable .fa-filter").on("click",function(){var s=n(this).position(),h=n(this).attr("data-field"),r=u.find('.table-filter-item[data-field="'+h+'"]'),t=n(this).closest("th"),e=t.outerWidth()+t.position().left-r.outerWidth()/2,i=0,o,f;t.hasClass("sortable")&&(i=24);t.hasClass("filterable")&&(i=i+12);o=t.closest("table").parent().scrollLeft();f=t.offset().left+t.outerWidth()-i+r.outerWidth()/2-n(window).width();i=i+o;f>0&&(e=e-f-16,$arrow=r.find(".card-arrow"),$arrow.css({left:"calc(50% - 0.5rem + "+(f+16)+"px)"}));r.css({top:s.top+v+50,left:e-i})});u.find(".is-tips").tooltip({container:"body",title:function(){return n(this).text()}});n.bb_table_resize(u)}else if(i==="width")return p=0,r?u.outerWidth(!0):n(window).outerWidth(!0)},timePicker:function(t){return n(t).find(".time-spinner-item").height()},datetimePicker:function(t,i){var r=n(t),f=r.attr("data-placement")||"auto",u=r.find(".datetime-picker-input");if(i)u.popover(i);else{u.popover({toggle:"datetime-picker",placement:f,template:'<div class="popover popover-datetime" role="tooltip"><div class="arrow"><\/div><h3 class="popover-header"><\/h3><div class="popover-body"><\/div><\/div>'}).on("inserted.bs.popover",function(){var t=this.getAttribute("aria-describedby"),i;t&&(i=n("#"+t),i.find(".popover-body").append(r.find(".date-picker").removeClass("d-none")))}).on("hide.bs.popover",function(){var u=this.getAttribute("aria-describedby"),t,i;u&&(t=n("#"+u),i=t.find(".date-picker"),t.find(".popover-body").append(i.clone()),r.append(i.addClass("d-none")))});n(".datetime-picker-input-icon").on("click",function(t){if(!n(this).hasClass("disabled")){t.stopImmediatePropagation();var i=n(this).parents(".datetime-picker-bar").find(".datetime-picker-input");i.trigger("click")}});n(".disabled .cell").on("click",function(n){n.preventDefault();n.stopImmediatePropagation()})}},bb_datetimeRange:function(t,i){var r=n(t),f=r.attr("data-placement")||"auto",u=r.find(".datetime-range-bar");if(i)u.popover(i);else{u.popover({toggle:"datetime-range",placement:f,template:'<div class="popover popover-datetime-range" role="tooltip"><div class="arrow"><\/div><h3 class="popover-header"><\/h3><div class="popover-body"><\/div><\/div>'}).on("inserted.bs.popover",function(){var t=this.getAttribute("aria-describedby"),i;t&&(i=n("#"+t),i.find(".popover-body").append(r.find(".datetime-range-body").addClass("show")))}).on("hide.bs.popover",function(){var u=this.getAttribute("aria-describedby"),t,i;u&&(t=n("#"+u),i=t.find(".datetime-range-body"),t.find(".popover-body").append(i.clone()),r.append(i.removeClass("show")))});r.find(".is-clear").on("click",function(){u.popover("hide")})}},bb_tab:function(t){n(t).tab("active")},captcha:function(t,i,r,u){u.remoteObj={obj:i,method:r};n(t).sliderCaptcha(u)},uploader:function(t,i,r,u,f,e,o){r?(options={},options.remoteObj={obj:i,complete:r,check:u,del:f,failed:e,setHeaders:o},n(t).uploader(options)):n(t).uploader(i)},collapse:function(t){var i=n(t),r=null;i.hasClass("is-accordion")&&(r="["+t.getAttributeNames().pop()+"]");n.each(i.children(".card").children(".collapse-item"),function(){var i=n(this),t=i.attr("id"),u;t||(t=n.getUID(),i.attr("id",t),r!=null&&i.attr("data-parent",r),u=i.prev().find('[data-toggle="collapse"]'),u.attr("data-target","#"+t).attr("aria-controls",t))});i.find(".tree .tree-item > .fa").on("click",function(){var t=n(this).parent();t.find('[data-toggle="collapse"]').trigger("click")});if(i.parent().hasClass("menu"))i.on("click",".nav-link:not(.collapse)",function(){var r=n(this),t;for(i.find(".active").removeClass("active"),r.addClass("active"),t=r.closest(".card");t.length>0;)t.children(".card-header").children(".card-header-wrapper").find(".nav-link").addClass("active"),t=t.parent().closest(".card")})},rate:function(t,i,r){var u=n(t),f;u.val=parseInt(u.attr("aria-valuenow"));f=function(){var t=u.find(".rate-item");t.each(function(t){t>u.val?n(this).removeClass("is-on"):n(this).addClass("is-on")})};u.on("mouseenter",".rate-item",function(){if(!u.hasClass("disabled")){var t=u.find(".rate-item"),i=t.toArray().indexOf(this);t.each(function(t){t>i?n(this).removeClass("is-on"):n(this).addClass("is-on")})}});u.on("mouseleave",function(){u.hasClass("disabled")||f()});u.on("click",".rate-item",function(){if(!u.hasClass("disabled")){var n=u.find(".rate-item");u.val=n.toArray().indexOf(this);u.attr("aria-valuenow",u.val+1);i.invokeMethodAsync(r,u.val+1)}})},footer:function(t,i){var r=n(t),u=r.tooltip();r.on("click",function(t){t.preventDefault();n(i||window).scrollTop(0);u.tooltip("hide")})},bb_anchor:function(t){var i=n(t);i.on("click",function(t){var f,u,r,e,o;t.preventDefault();f=n(i.data("target"));u=i.data("container");u||(u=window);r=f.offset().top;e=f.css("marginTop").replace("px","");e&&(r=r-parseInt(e));o=i.data("offset");o&&(r=r-parseInt(o));n(u).scrollTop(r)})},bb_editor:function(t,i,r,u,f,e,o){var s=function(){var r=t.getElementsByClassName("editor-body"),u;i==="code"?n(r).hasClass("open")?n(r).summernote("code",o):n(r).html(o):(u={obj:i,method:f,height:e},o&&(u.value=o),n.html5edit(r,u))};r!==""?i.invokeMethodAsync(r).then(t=>{for(var r in t)(function(t,r){r!=null&&(pluginObj={},pluginObj[r]=function(f){var e=n.summernote.ui;f.memo("button."+r,function(){var n=e.button({contents:'<i class="'+t.iconClass+'"><\/i>',container:"body",tooltip:t.tooltip,click:function(){i.invokeMethodAsync(u,r).then(n=>{f.invoke("editor.insertText",n)})}});return this.$button=n.render(),this.$button})},n.extend(n.summernote.plugins,pluginObj))})(t[r],t[r].pluginItemName);s()}):s()},split:function(t){var i=n(t),f=i.innerWidth(),e=i.innerHeight(),u=0,r=0,o=0,s=0,h=!i.children().hasClass("is-horizontal");i.children().children(".split-bar").drag(function(n){h?(s=n.clientY||n.touches[0].clientY,u=i.children().children(".split-left").innerHeight()*100/e):(o=n.clientX||n.touches[0].clientX,u=i.children().children(".split-left").innerWidth()*100/f);i.toggleClass("dragging")},function(n){var t,c;h?(t=n.clientY||n.changedTouches[0].clientY,r=Math.ceil((t-s)*100/e)+u):(c=n.clientX||n.changedTouches[0].clientX,r=Math.ceil((c-o)*100/f)+u);r<=0&&(r=0);r>=100&&(r=100);i.children().children(".split-left").css({"flex-basis":r.toString()+"%"});i.children().children(".split-right").css({"flex-basis":(100-r).toString()+"%"});i.attr("data-split",r)},function(){i.toggleClass("dragging")})},bb_layout:function(t,i){n(".layout-header").find('[data-toggle="tooltip"]').tooltip();n(window).on("resize",function(){r()});var r=function(){var r=n(window).width();t.invokeMethodAsync(i,r)};r()},bb_scroll:function(t,i){var r=n(t),o=n(window).width()<768||navigator.userAgent.match(/Macintosh/);if(i||!o){var s=r.attr("data-hide"),u=r.attr("data-height"),e=r.attr("data-width"),f={alwaysVisible:s!=="true"};u||(u="auto");u!==""&&(f.height=u);e||(f.width=e);r.slimScroll(f)}else r.addClass("is-phone")},markdown:function(t,i){var o="bb_editor",u=n(t),f,e,r;if(i){if(r=u.data(o),r)return f=r[i](),console.log(f),f}else e=n.getUID(),u.attr("id",e),r=editormd(e,{saveHTMLToTextarea:!0,path:"/lib/"}),u.data(o,r)},bb_console_log:function(t){var u=n(t),i=u.find('[data-scroll="auto"]'),r;i.length>0&&(r=i.find(".console-window"),i.scrollTop(r.height()))},bb_multi_select:function(t,i,r){n(t).data("bb_multi_select",{obj:i,method:r})},bb_tree:function(t){var i=n(t);i.find(".tree-content").hover(function(){n(this).parent().addClass("hover")},function(){n(this).parent().removeClass("hover")})},bb_barcode:function(t,i,r,u){var f=n(t),e=new ZXing.BrowserMultiFormatReader;f.attr("data-scan")==="Camera"&&e.getVideoInputDevices().then(n=>{i.invokeMethodAsync("InitDevices",n).then(()=>{if(u&&n.length>0){var t=f.find('button[data-method="scan"]'),i=f.attr("data-scan");i==="Camera"&&t.trigger("click")}})});f.on("click","button[data-method]",function(){var r=n(this).attr("data-method"),o,s,u,t;if(r==="scan")i.invokeMethodAsync("Start"),o=f.find(".dropdown-item.active").attr("data-val"),s=f.find("video").attr("id"),e.decodeFromVideoDevice(o,s,(t,r)=>{if(t){n.bb_vibrate();console.log(t.text);i.invokeMethodAsync("GetResult",t.text);var u=f.attr("data-autostop")==="true";u&&e.reset()}!r||r instanceof ZXing.NotFoundException||(console.error(r),i.invokeMethodAsync("GetError",r))});else if(r==="scanImage"){e=new ZXing.BrowserMultiFormatReader;f.find(":file").remove();u=n(".scanner-image");t=n('<input type="file" hidden accept="image/*">');f.append(t);t.on("change",function(){if(this.files.length!==0){var t=new FileReader;t.onloadend=function(t){u.attr("src",t.target.result);e.decodeFromImage(u[0]).then(t=>{t&&(n.bb_vibrate(),console.log(t.text),i.invokeMethodAsync("GetResult",t.text))}).catch(n=>{n&&(console.log(n),i.invokeMethodAsync("GetError",n.message))})};t.readAsDataURL(this.files[0])}});t.trigger("click")}else r==="close"&&(e.reset(),i.invokeMethodAsync("Stop"))})},bb_camera:function(t,i,r,u){var f=n(t);navigator.mediaDevices.enumerateDevices().then(function(t){var e=t.filter(function(n){return n.kind==="videoinput"});i.invokeMethodAsync("InitDevices",e).then(()=>{u&&e.length>0&&f.find('button[data-method="play"]').trigger("click")});var r=f.find("video")[0],o=f.find("canvas")[0],h=o.getContext("2d"),s;f.on("click","button[data-method]",function(){var e=n(this).attr("data-method"),t,c,u;if(e==="play"){var v=n(this).attr("data-camera"),l=f.find(".dropdown-item.active").attr("data-val"),a={video:{facingMode:v},audio:!1};l!==""&&(a.video.deviceId={exact:l});navigator.mediaDevices.getUserMedia(a).then(n=>{r.srcObject=n,r.play(),s=n.getTracks()[0],i.invokeMethodAsync("Start")}).catch(n=>{console.log(n),i.invokeMethodAsync("GetError",n.message)})}else e==="stop"?(r.pause(),r.srcObject=null,s.stop(),i.invokeMethodAsync("Stop")):e==="capture"&&(h.drawImage(r,0,0,300,200),t=o.toDataURL(),console.log(t),i.invokeMethodAsync("Capture"),c=f.find("img"),c.length===1&&c.attr("src",t),u=f.find("a.download"),u.attr("href",t),u.attr("download",(new Date).format("yyyyMMddHHmmss")+".png"),u[0].click())})})},bb_vibrate:function(){if("vibrate"in window.navigator){window.navigator.vibrate([200,100,200]);var n=window.setTimeout(function(){window.clearTimeout(n);window.navigator.vibrate([])},1e3)}},bb_qrcode:function(t){var u=n(t),f=u.find(".qrcode-img"),i,r,e;f.html("");i="";r=null;arguments.length===2?i=arguments[1]:(i=arguments[2],r=arguments[1]);i==="generate"&&(e=u.find(".qrcode-text").val(),qrcode=new QRCode(f[0],{text:e,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H}),r.invokeMethodAsync("Generated"))},bb_select:function(t){var i=n("#"+t),r=i.find("input.search-text");if(r.length>0)i.on("shown.bs.dropdown",function(){r.focus()})}});n(function(){new MutationObserver((n,t)=>{if(document.querySelector("#components-reconnect-modal h5 a")){function n(){fetch("").then(()=>{location.reload()})}t.disconnect();n();setInterval(n,1e4)}}).observe(document.body,{childList:!0,subtree:!0});n(document).on("hidden.bs.toast",".toast",function(){n(this).removeClass("hide")}).on("inserted.bs.tooltip",".is-invalid",function(){n("#"+n(this).attr("aria-describedby")).addClass("is-invalid")});n.fn.popover.Constructor.prototype.isWithContent=function(){var n=this.config.toggle;return["","confirm","datetime-picker","datetime-range"].indexOf(n)||this.getTitle()||this._getContent()};var t=function(t){var i=null,r=t.parents(".popover"),u;return r.length>0&&(u=r.attr("id"),i=n('[aria-describedby="'+u+'"]')),i};n(document).on("click",function(i){var o=!0,r=n(i.target),a=t(r),u,f,s,h,e,c,l;(a!=null&&(o=!1),o&&n('[data-toggle="confirm"][aria-describedby^="popover"]').popover("hide"),r.parents(".popover-datetime.show").length===0&&n(".popover-datetime.show").each(function(){var t=this.getAttribute("id"),i;t&&(i=n('[aria-describedby="'+t+'"]'),r.attr("aria-describedby")!==t&&i.popover("hide"))}),r.parents(".popover-datetime-range.show").length===0&&n(".popover-datetime-range.show").each(function(){var t=this.getAttribute("id"),i;t&&(i=n('[aria-describedby="'+t+'"]'),r.parents(".datetime-range-bar").attr("aria-describedby")!==t&&i.popover("hide"))}),u=n(i.target),f=u.closest(".popover-datetime"),f.length==1&&(s=f.attr("id"),r=n('[aria-describedby="'+s+'"]'),r.closest(".datetime-picker").hasClass("is-filter")))||(h=u.closest(".table-filter-item"),h.length==0&&n(".table-filter-item.show").each(function(){var t=n(this).data("bb_filter");t.obj.invokeMethodAsync(t.method)}),e=u.closest(".multi-select"),n(".multi-select.show").each(function(){if(e.length===0||this!=e[0]){var t=n(this).data("bb_multi_select");t.obj.invokeMethodAsync(t.method)}}),c=u.closest(".btn-col.init"),c.hasClass("init")||(l=u.closest(".dropdown-menu.dropdown-menu-right.show"),l.length===0&&n(".table-toolbar-button .dropdown-menu.show").removeClass("show")))});n(document).on("click",".popover-confirm-buttons .btn",function(i){var r,u,f;i.stopPropagation();r=t(n(this));r!=null&&(r.popover("hide"),u=r.attr("id"),$ele=n('[data-target="'+u+'"]'),f=this.getAttribute("data-dismiss")==="confirm"?$ele.find(".popover-confirm-buttons .btn:first"):$ele.find(".popover-confirm-buttons .btn:last"),f.trigger("click"))});n(document).on("keyup",function(t){var i;t.key==="Enter"?(i=n(".table-filter .table-filter-item.show:first").data("bb_filter"),i&&i.obj.invokeMethodAsync("ConfirmByKey")):t.key==="Escape"&&(i=n(".table-filter .table-filter-item.show:first").data("bb_filter"),i&&i.obj.invokeMethodAsync("EscByKey"))})})})(jQuery);